<div class="centered-container">
	<div class="object-overview-container" *ngIf="event">
		<div class="object-info-title">
			<span>
			{{event.title}}
			</span>

			<mat-menu #menu="matMenu">
				<a mat-menu-item
				   *ngIf="userCanEditEvent$ | async"
				   matTooltip="Dieses Event bearbeiten"
				   routerLink="./edit">
					<mat-icon>edit</mat-icon>
					<span>Bearbeiten</span>
				</a>
				<a mat-menu-item
				   *ngIf="userCanAccessEntries$ | async"
				   matTooltip="Kosten dieses Events anzeigen"
				   routerLink="/management/costs"
				   [queryParams]="{eventIds: event.id}">
					<mat-icon>payment</mat-icon>
					Kosten
				</a>
			</mat-menu>
			<button mat-icon-button [matMenuTriggerFor]="menu"
					*ngIf="(userCanEditEvent$ | async) || (userCanAccessEntries$ | async)">
				<mat-icon>
					more_vert
				</mat-icon>
			</button>
		</div>

		<div class="object-info-container">
			<div class="object-info" *ngFor="let overviewKey of overviewKeys">
				<div [ngSwitch]="overviewKey.pipe">
					<ng-template [ngSwitchCase]="'price'">{{getValue(overviewKey.key) | async | currency:'EUR':'symbol'}}
					</ng-template>
					<ng-template [ngSwitchCase]="'date'">{{getValue(overviewKey.key) | async | moment:'DD.MM.'}}
					</ng-template>
					<ng-template ngSwitchDefault>{{getValue(overviewKey.key) | async}}</ng-template>
				</div>
				<div class="secondary-text">
					{{overviewKey.label}}
				</div>
			</div>
		</div>
		<div class="add-to-cart-container">
			<form #addToCartForm="ngForm" (ngSubmit)="addOrDeleteFromCart(event)">
				<ng-template [ngIf]="isMerch(event)">
					<mat-form-field>
						<mat-select [(ngModel)]="color"
									(change)="updateMaxAmount()"
									placeholder="Farbe"
									[required]="true"
									name="colorSelectionInput">
							<mat-option *ngFor="let color of colorSelection$ | async"
										[value]="color">
								{{color.name}}
							</mat-option>
						</mat-select>
					</mat-form-field>
					<mat-form-field>
						<mat-select [(ngModel)]="size"
									(change)="updateMaxAmount()"
									placeholder="Größe"
									[required]="true"
									name="sizeSelectionInput">
							<mat-option *ngFor="let size of sizeSelection$ | async" [value]="size">
								{{size}}
							</mat-option>
						</mat-select>
					</mat-form-field>
				</ng-template>

				<mat-form-field>
					<mat-select placeholder="Anzahl" name="amount"
								[(ngModel)]="model.amount" (ngModelChange)="updateShoppingCart()"
								[disabled]="!isMerch(event) && isPastEvent"
								[required]="true">
						<mat-option *ngFor="let number of amountOptions" [value]="number">
							{{number}}
						</mat-option>
					</mat-select>
				</mat-form-field>

				<button [disabled]="(!addToCartForm.valid || model.amount === 0) || (!isMerch(event) && isPastEvent)"
						mat-raised-button
						color="{{(isPartOfShoppingCart) ? 'warn' : 'accent'}}"
						class="add-to-cart-button">
					{{(isPartOfShoppingCart) ? 'Aus dem Warenkorb löschen' : 'In den Warenkorb'}}
				</button>
			</form>
		</div>

		<share-buttons
			*ngIf="event"
			[theme]="'default'"
			[include]="['facebook','twitter','whatsapp','telegram','copy']"
			[size]="-2"
			[title]="event.title"
			[image]="event.imagePaths[0]"
			[description]="event.description"
			[tags]="['Meilenwoelfe', 'Meilenwoelfe-Shop']"
		></share-buttons>
	</div>


</div>
